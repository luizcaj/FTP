[{"name":"App.R","content":"library(shiny)\r\nlibrary(ggplot2)\r\nlibrary(data.table)\r\n\r\n# Set working directory\r\n#setwd('C:/Users/juniorluiz02/OneDrive - Sicredi/Desktop/Demandas/Dash CF')\r\nsetwd('Z:/Dash_CF')\r\n\r\n\r\n# Load data/\r\ndb_completa <- fread(\"curvas_v2.csv\", sep = ',')\r\n\r\n\r\n\r\n\r\n\r\n# Calculate Saldo_pct\r\n#db_completa <- db %>%\r\n##  group_by(cod_coop, cod_tema, AnoMesAplic, num_ano_mes) %>%\r\n#  mutate(Saldo_pct = Saldo / sum(Saldo) * 100) \r\n\r\n\r\n\r\n\r\n\r\n\r\n# Define UI for application\r\nui <- fluidPage(\r\n  titlePanel(\"Comparação FTP\"),\r\n  \r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      selectInput(\"cod_coop\", \"Seleciona cod_coop:\", choices = unique(db_completa$cod_coop)),\r\n      selectInput(\"cod_tema\", \"Seleciona cod_tema:\", choices = unique(db_completa$cod_tema)),\r\n      selectInput(\"AnoMesAplic\", \"Seleciona AnoMesAplic:\", choices = unique(db_completa$AnoMesAplic)),\r\n      selectInput(\"num_ano_mes\", \"Seleciona num_ano_mes:\", choices = unique(db_completa$num_ano_mes))\r\n    ),\r\n    \r\n    mainPanel(\r\n      plotOutput(\"plot1\"),\r\n      plotOutput(\"plot2\")\r\n    )\r\n  )\r\n)\r\n\r\n# Define server logic\r\nserver <- function(input, output) {\r\n  filtered_data <- reactive({\r\n    db_completa[cod_coop == input$cod_coop &\r\n        cod_tema == input$cod_tema &\r\n        AnoMesAplic == input$AnoMesAplic &\r\n        num_ano_mes == input$num_ano_mes\r\n    ]\r\n  })\r\n  \r\n  output$plot1 <- renderPlot({\r\n    ggplot(filtered_data(), aes(x = as.factor(carencia), y = tx_media)) +\r\n      geom_col(fill = \"#3FA110\", color = \"black\") +\r\n      labs(title = \"Taxa vs. Carência\", x = \"Carência\", y = \"Tx_media\") +\r\n      ylim(0, 120) +\r\n      theme_bw()\r\n  })\r\n  \r\n  output$plot2 <- renderPlot({\r\n    ggplot(filtered_data(), aes(x = as.factor(carencia), y = Saldo_pct)) +\r\n      geom_col(fill = \"#3FA110\", color = \"black\") +\r\n      labs(title = \"Saldo vs. Carência\", x = \"Carência\", y = \"Saldo (em %)\") +\r\n      theme_bw()\r\n  })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
